<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>【文斌 & 静静】爱的小窝-我们的精彩</title>
<link rel="shortcut icon" href="/static/images/favicon.ico" type="image/x-icon" />
<link href="/static/css/style.css" rel="stylesheet" type="text/css">
<link href="/static/css/bootstrap-responsive.css" rel="stylesheet" type="text/css">
<link href="/static/css/bootstrap.css" rel="stylesheet" type="text/css">
<link href="/static/css/countdown.css" rel="stylesheet" type="text/css">
<link href="/static/css/prettyPhoto.css" rel="stylesheet">
<script type="text/javascript" src="/static/js/jquery-1.8.3.js"></script>
<script type="text/javascript" src="/static/js/mobile.js"></script>
<script type="text/javascript" src="/static/js/bootstrap.js"></script>
<script type="text/javascript" src="/static/js/jquery.prettyPhoto.js"></script>
<script type="text/javascript" src="/static/js/lightbox.js"></script>
<script type="text/javascript" src="/static/js/jquery.cookie.js"></script>
<script type="text/javascript" src="/static/js/scrolltopcontrol.js"></script>
<style>
    .inner, .container{
        width: 100% !important;
    }
    body {
        padding-right:0px;
        padding-left:0px
    }
</style>
</head>
	<body>

<!--Background Image-->
<img src="/static/images/bg.jpg" id="background"/>
<!--Background Image-->
<!--WRAPPTER START-->
<div class="wrapepr floral-bg">
	<!--header start-->
    <div class="header">
        <div class="clearfix"></div>
        <div class="container">
        <div class="couple-name">
            <div class="couple-name-holder">
                <div class="first-name resize">
                	<h1>刘文斌</h1>
                </div>
                <img src="/static/images/heart3.png" style="margin-left: 10px;width:21%"/>
                <div class="last-name resize">
                    <h1>陈晓静</h1>
                </div>
            </div>
        </div>
        <div class="inner">
        <div class="getting-merried">
        	<p>爱的小窝</p>
        </div>
        </div>
      </div>
      </div>
      <div class="clearfix"></div>
    <!--header start-->
    <div class="content">
        <div class="inner">
            <!--navigation start-->
            <div class="navigation relative">
            	<span class="border1 resize">
                	<span class="border2"></span>
                </span>
                <ul id="nav">
                    <li><a href="/static/index.html">首页</a></li>
                    <li><a href="/static/travel.html">我们的旅程</a></li>
                    <li><a href="/static/memory.html">我们的回忆</a></li>
                    <li><a href="/static/gallery.html">我们的精彩</a></li>
                    <li><a href="/static/privity.html">我们的默契</a></li>
                    <li><a href="/static/location.html">我在这里</a></li>
                </ul>
            </div>
            <!--navigation end-->
            <div class="clearfix"></div>
            <!--content start-->
            <!--banners start-->
            	<div class="banner relative">
                	<img src="/static/images/banner-img.png" alt="">
                    <h2>我们的精彩</h2>
                	<div class="banner-pettern"></div>
                </div>
                <div class="clearfix"></div>
            <div class="inner padding14px resize">
               <div class="bs-docs-example">
            <ul class="nav nav-tabs" id="myTab">
              <li id="date1" class="active"><a data-toggle="tab" href="#"></a></li>
              <li id="date2" class=""><a data-toggle="tab" href="#"></a></li>
              <li id="date3" class=""><a data-toggle="tab" href="#"></a></li>
            </ul>
            <div class="tab-content padding26px" id="myTabContent">
              <div id="video" class="tab-pane fade active in">
                <div class="gallery-page">
               	<section id="gal-container1">
                    <div id="errorMsg"></div>
                    <ul class="cs_gal_2_column pretty-photos clearfix">
                        <li>
                            <div class="gallery_img relative">
                                <img alt="" src="">
                                <div class='fenlei alert alert-info' style='display:none;margin-top:10px;margin-bottom:10px;background-color:#f2f6f7;border-color:#fff'></div>
                            </div>
                        </li>
                        <li>
                            <div class="gallery_img relative">
                                <img alt="" src="">
                                <div class='fenlei alert alert-info' style='display:none;margin-top:10px;margin-bottom:10px;background-color:#f2f6f7;border-color:#fff'></div>
                            </div>
                        </li>
                        <li>
                            <div class="gallery_img relative">
                                <img alt="" src="">
                                <div class='fenlei alert alert-info' style='display:none;margin-top:10px;margin-bottom:10px;background-color:#f2f6f7;border-color:#fff'></div>
                            </div>
                        </li>
                        <li>
                            <div class="gallery_img relative">
                                <img alt="" src="">
                                <div class='fenlei alert alert-info' style='display:none;margin-top:10px;margin-bottom:10px;background-color:#f2f6f7;border-color:#fff'></div>
                            </div>
                        </li>
                        <li>
                            <div class="gallery_img relative">
                                <img alt="" src="">
                                <div class='fenlei alert alert-info' style='display:none;margin-top:10px;margin-bottom:10px;background-color:#f2f6f7;border-color:#fff'></div>
                            </div>
                        </li>
                        <li>
                            <div class="gallery_img relative">
                                <img alt="" src="">
                                <div class='fenlei alert alert-info' style='display:none;margin-top:10px;margin-bottom:10px;background-color:#f2f6f7;border-color:#fff'></div>
                            </div>
                        </li>
                    </ul>
                </section> 
               </div>
              </div>
            </div>
          </div>
               <div class="gallery-pagination">
                    <ul id="pages"></ul>
               </div>

                <div class="register" style="padding:4px 0;text-align: center" id="totalPage"></div>
                <div class="clearfix"></div>
            </div>
            <!--content end-->
        </div>
    </div>
    <div class="clearfix"></div>
</div>
<script>
    var date = new Date();
    var year = date.getYear() + 1900;
    var month = date.getMonth() + 1;
    var requestData1 = "";
    var requestData2 = "";
    var requestData3 = "";
    var date1 = "";
    var date2 = "";
    var date3 = "";
    if(month < 10){
        requestData1 = year + "0" + month;
        date1 = year + "年0" + month + "月";
    }else{
        requestData1 = year + "" + month;
        date1 = year + "年" + month + "月";
    }
    month = month - 1;
    if(month <= 0){
        month = 12 - month;
        year = year - 1;
    }
    if(month < 10){
        requestData2 = year + "0" + month;
        date2 = year + "年0" + month + "月";
    }else{
        requestData2 = year + "" + month;
        date2 = year + "年" + month + "月";
    }

    month = month - 1;
    if(month <= 0){
        month = 12 - month;
        year = year - 1;
    }
    if(month < 10){
        requestData3 = year + "0" + month;
        date3 = year + "年0" + month + "月";
    }else{
        requestData3 = year + "" + month;
        date3 = year + "年" + month + "月";
    }
    $("#date1").attr("requestData",requestData1);
    $("#date1 a").html(date1);

    $("#date2").attr("requestData",requestData2);
    $("#date2 a").html(date2);

    $("#date3").attr("requestData",requestData3);
    $("#date3 a").html(date3);

    $("#myTab li").click(function(){
        getImgByMonthAndPage($(this).attr("requestData"),1);
    });

    getImgByMonthAndPage(requestData1,1);
    function getImgByMonthAndPage(month,page){
        $.ajax({
            url:"/getImageByMonthPage",
            dataType: 'json',
            type:"POST",
            data:"month="+month+"&page="+page,
            success:function(data){
                $("#errorMsg").html("");
                if(data.totalImgCount == undefined){
                    $("#errorMsg").html("该月暂无照片，等待完善哦");
                    $("#gal-container1 li").hide();
                    $("#gal-container1 img").attr("src","");
                    $("#totalPage").html("");
                    $("#pages").html("");
                    return false;
                }
                var totalImgCount = data.totalImgCount;
                var totalPageNum = data.totalPageNum;
                var currentPageNum = data.currentPageNum;
                $("#totalPage").html("<b>有"+totalImgCount+"张照片，共"+totalPageNum + "页，当前是第"+currentPageNum+"页</b>");
                var pages = mathPages(currentPageNum,totalPageNum);
                var html = "<li onclick=\"getImgByMonthAndPage('"+month+"',"+(currentPageNum - 1)+")\"><a href=\"javascript:;\">&nbsp;上一页&nbsp;</a></li>"
                for(var i = 0;i < pages.length;i++){
                    html += "<li onclick=\"getImgByMonthAndPage('"+month+"',"+pages[i]+")\"><a href=\"javascript:;\">&nbsp;"+pages[i]+"&nbsp;</a></li>";
                }
                html += "<li onclick=\"getImgByMonthAndPage('"+month+"',"+(currentPageNum + 1)+")\"><a href=\"javascript:;\">&nbsp;下一页&nbsp;</a></li>";
                $("#pages").html(html);
                $("#pages li:contains("+currentPageNum+")").html("<a href=\"javascript:;\"><font color='#f1a693'><b>"+currentPageNum+"</b></font></a>");

                $("#gal-container1 li").hide();
                $("#gal-container1 img").attr("src","");
                $("#gal-container1").find("li").each(function (i,n) {
                    if(data.imgList[i] != undefined){
                        $(n).show();
                        $(n).find("img").attr("src",data.imgList[i]);
                    }
                });
                $("#pages").css("margin-left",($(".gallery-pagination").width()-$("#pages").width())/2);
            }
        });
    }

    function mathPages(index, totalpage) { //页码和一共有多少页
        //需要展现的页数
        var showPageCount = 9;
        var indexs = [];
        for(var i = 1; i <= totalpage; i++) {
            indexs.push(i);   //先根据总页数创建数组，将全部页标添加到数组中
        }
        if(totalpage<=showPageCount){
            return indexs;  //总页数<=6页时，直接输出即可
        }
        if(index<=2){
            indexs = indexs.slice(0,showPageCount);   //当前页<=2时，当前页的页标就不能显示在第三位了，直接截取0~6输出
            return indexs;
        }else{
            var indexs2 = indexs.slice(index-(showPageCount / 2),index+(showPageCount / 2));
            //如果当前页标>2，则从当前页标-3开始截取总页标数组，截取6个
            if(indexs2.length>=showPageCount){
                return indexs2;  //如果当前页不是倒数后3页，则截取没问题，直接输出
            }else{
                indexs2 = indexs.slice(-showPageCount);
                return indexs2;  //如果当前页是倒数后3页，就截取不到6个页标，那么直接最后截取6个页标即可
            }
        }
    }
    $(".gallery_img img").click(function(){
        var div = $(this).next()
        if(div.html() == ""){
            $.ajax({
                url:"/getImageInfo",
                dataType: 'json',
                type:"POST",
                data:"imgPath="+$(this).attr("src"),
                success:function(data){
                    var html = "地点名称："+data.travelName+"<br/>";
                    html += "旅行时间："+data.travelTime+"<br/>";
                    html += "地点："+data.address+"<br/>";
                    html += "图片名称："+data.imgName+"<br/>";
                    html += "缩略图："+data.smallImgSize+"K&nbsp;&nbsp;";
                    html += "原始图："+data.originImgSize+"K<br/><hr style='margin:8px 0'/>";
                    html += "<button class='btn btn-primary' onclick='downloadOriginImg("+data.travelId+",\""+data.imgName+"\")'>下载原图</button>";
                    html += "<button class='btn btn-primary' onclick='gotoTravel("+data.travelId+")'>跳转到旅程</button>";
                    div.html(html);
                }
            });
        }
        $(".fenlei").hide();
        div.show();
    });
    function downloadOriginImg(id,imgName){
        window.open("/download/GalleryImg?in="+imgName+"&id="+id);
    }
    function gotoTravel(id){
        location.href = "/static/mobile/travel.html?id="+id;
    }
</script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?18aa1da465cbe156fc3e7c413f9b2add";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>
</html>
