<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>【文斌 & 静静】爱的小窝-我们的回忆</title>
<link rel="shortcut icon" href="/static/images/favicon.ico" type="image/x-icon" />
<link href="/static/css/style.css" rel="stylesheet" type="text/css">
<link href="/static/css/bootstrap-responsive.css" rel="stylesheet" type="text/css">
<link href="/static/css/bootstrap.css" rel="stylesheet" type="text/css">
<link href="/static/css/countdown.css" rel="stylesheet" type="text/css">
<link href="/static/css/prettyPhoto.css" rel="stylesheet">
<link href="/static/css/calendar.css" rel="stylesheet">
<script type="text/javascript" src="/static/js/jquery-1.8.3.js"></script>
<script type="text/javascript" src="/static/js/mobile.js"></script>
<script type="text/javascript" src="/static/js/bootstrap.js"></script>
<script type="text/javascript" src="/static/js/jquery.countdown.js"></script>
<script type="text/javascript" src="/static/js/custom.js"></script>
<script type="text/javascript" src="/static/js/jquery.cookie.js"></script>
<script type="text/javascript" src="/static/js/calendar.js"></script>
<script type="text/javascript" src="/static/js/scrolltopcontrol.js"></script>
<style>
    .inner, .container{
        width: 100% !important;
    }
    body {
        padding-right:0px;
        padding-left:0px
    }
</style>
</head>
	<body>

<!--Background Image-->
<img src="/static/images/bg.jpg" id="background"/>
<!--Background Image-->
<!--WRAPPTER START-->
<div class="wrapepr floral-bg">
	<!--header start-->
    <div class="header">
        <div class="clearfix"></div>
        <div class="container">
        <div class="couple-name">
            <div class="couple-name-holder">
                <div class="first-name resize">
                	<h1>刘文斌</h1>
                </div>
                <img src="/static/images/heart3.png" style="margin-left: 10px;width:21%"/>
                <div class="last-name resize">
                    <h1>陈晓静</h1>
                </div>
            </div>
        </div>
        <div class="inner">
        <div class="getting-merried">
        	<p>爱的小窝</p>
        </div>
        </div>
      </div>
      </div>
      <div class="clearfix"></div>
    <!--header start-->
    <div class="content">
        <div class="inner">
            <!--navigation start-->
            <div class="navigation relative">
            	<span class="border1 resize">
                	<span class="border2"></span>
                </span>
                <ul id="nav">
                    <li><a href="/static/index.html">首页</a></li>
                    <li><a href="/static/travel.html">我们的旅程</a></li>
                    <li><a href="/static/memory.html">我们的回忆</a></li>
                    <li><a href="/static/gallery.html">我们的精彩</a></li>
                    <li><a href="/static/privity.html">我们的默契</a></li>
                    <li><a href="/static/location.html">我在这里</a></li>
                </ul>
            </div>
            <!--navigation end-->
            <div class="clearfix"></div>
            <!--content start-->
            <!--banners start-->
            	<div class="banner relative">
                	<img src="/static/images/banner-img.png" alt="">
                    <h2>我们的回忆</h2>
                	<div class="banner-pettern"></div>
                </div>
                <div class="clearfix"></div>
                <!--banners end-->
            <div class="inner padding40px resize">
                <div class="events pretty-photos">
                    <div class="rightbar">
                    	<!--location map widget start-->
                    	<div class="widget map">
                            <div id="chatTongji" class="alert alert-info" role="alert">

                            </div>
                        </div>
                    </div>
                    <div class="rightbar" style="margin-bottom: 50px">
                    	<!--location map widget start-->
                    	<div class="widget map">
                        	<!--heading start-->
                        	<div class="heading">
                            	<h2>时间</h2>
                                <span class="dot-left"></span>
                                <span class="dot-right"></span>
                            </div>
                            <!--heading start-->
                            <div id="ca"></div>
                        </div>
                    </div>
                    <div class="leftbar">
                    	<!--event box start-->
                        <h2 id="chatTitle">聊天记录</h2>
                        <div id="images" class="relative">

                        </div>
                    </div>
                </div>
                <div class="register" style="padding:1px 0"></div>
                <div class="clearfix"></div>
            </div>
            <!--content end-->
        </div>
    </div>
    <div class="clearfix"></div>
</div>
<script>
    $('#ca').calendar({
        width: $(document).width() * 0.85,
        height: 240,
        onSelected: function (view, date, data) {
            var month = date.getMonth()+1;
            if(month < 10){
                month = "0" + month;
            }
            var day = date.getDate();
            if(day < 10){
                day = "0" + day;
            }
            var dateStr = (1900 + date.getYear())+"-"+month+"-"+day;
            getImagePathByDate(dateStr);
        }
    });
    $("#ca ul").css("margin","0");
    $("#ca ol").css("margin","0");
    function getImagePathByDate(date){
        $.ajax({
            url:"/getImagePath",
            dataType: 'json',
            data:"date="+date,
            type:"POST",
            success:function(data){
                $("#chatTitle").html(date + " 聊天记录");
                if(null == data){
                    $("#images").html("暂无聊天记录");
                }else{
                    var imageHtml = ""
                    $.each(data,function(i,n){
                        imageHtml += "<div class=\"story-avatar relative\" style='background-color:#fff'>";
                        imageHtml += "<img style='width:100%' alt=\"\" src=\""+n+"\">";
                        imageHtml += "</div>";
                    });
                    $("#images").html(imageHtml);
                    $("#lbs").remove();
                    var script = document.createElement("script");
                    script.src = "/static/js/lightbox.js";
                    script.id = "lbs";
                    document.body.appendChild(script);
                }
            }
        });
    }
    function init(){
        $.ajax({
            url:"/getLastChatDate",
            type:"POST",
            success:function(data){
                getImagePathByDate(data);
            }
        });
        $.ajax({
            url:"/getChatTongji",
            type:"POST",
            success:function(data){
                data = data[0];
                html = "<b>从我们相遇的日子到现在：</b><br/>";
                html += "我们总语音通话" + data.voiceCount + "次<br/>"
                html += "总语音聊天时长为："+ operateTime(data.voiceTime * 1)+"</br>";
                var movieTime = Math.floor((data.voiceTime * 1) / 8949 * 10) / 10;
                html += "相当于看了"+movieTime+"遍漫威最长电影《复联3》<br><br>";
                html += "聊天记录总字数为："+data.wordLength+"字<br>";
                var bookTime = Math.floor((data.wordLength * 1) / 54715 * 10) / 10;
                html += "相当于"+bookTime+"本《小王子》";
                $("#chatTongji").html(html);
            }
        });
    }
    function operateTime(time){
        var result = "";
        var day = parseInt(time / 86400);
        if(0 != day){
            result += day + "天"
        }
        time = time - day * 86400;
        var hour = parseInt(time / (60 * 60))
        result += hour + "小时"

        time = time - hour * (60 * 60)
        var min = parseInt(time / 60)
        result += min + "分钟"

        time = time - min * 60
        result += time + "秒"
        return result
    }
    init();
</script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?18aa1da465cbe156fc3e7c413f9b2add";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>
</html>
